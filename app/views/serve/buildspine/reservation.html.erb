<%= title '龙氏脊筑服务预约' %>
<head>
  <script type="text/javascript">
  function showCustomer() {
    var workStr=document.getElementById("work").value,
        rankStr=document.getElementById("rank").value;
    if (!workStr || !rankStr) {
      return false;
    }
    var xmlhttp;
    if (window.XMLHttpRequest) {
      xmlhttp=new XMLHttpRequest();
    } else {
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function() {
      if (xmlhttp.readyState==4 && xmlhttp.status==200) {
        console.log(xmlhttp.responseText);
      }
    }
    xmlhttp.open("GET","search/?work="+workStr+"&rank="+rankStr,true);
    xmlhttp.send();
    }
    // 联动的js代码，传入后台的数据是工作站的ID和级别的ID,然后根据这两个ID在SpineBuild脊筑师表中对应外键查找相应的数据
  </script>
</head>
<body>
  <%= form_for @reservation, url: {action: "new"}, html: {class: "nifty_form"} do |f| %>
  <div class="weui-cells__title">基础信息</div>
  <div class="weui-cells weui-cells_form">
      <div class="weui-cell">
          <div class="weui-cell__hd"><label class="weui-label">姓名</label></div>
          <div class="weui-cell__bd">
            <%= f.text_field :name ,class:"weui-input",type:"text", placeholder:"请输入姓名"%>
          </div>
      </div>
        <div class="weui-cell">
          <div class="weui-cell__hd"><label class="weui-label">手机号</label></div>
          <div class="weui-cell__bd">
            <%= f.text_field :tel,class:"weui-input",type:"number",pattern:"[0-9]*", placeholder:"请输入手机号"%>
          </div>
      </div>
      <div class="weui-cell">
          <div class="weui-cell__hd"><label for="" class="weui-label">时间</label></div>
          <div class="weui-cell__bd">
            <%= f.text_field :time ,class:"weui-input",type:"datetime-local"%>
          </div>
      </div>
  </div>
  <div class="weui-cells__title">选择</div>
  <div class="weui-cells">
      <div class="weui-cell weui-cell_select weui-cell_select-after">
          <div class="weui-cell__hd">
              <label for="" class="weui-label">工作站</label>
          </div>
          <div class="weui-cell__bd">
              <select class="weui-select" name="work" id="work" onchange="showCustomer()">
                <option value="">请选择</option>
                <% @work.each do |work|%>
                  <option value="<%= work.id %>"><%= work.name %></option>
                <% end %>
              </select>
          </div>
      </div>
      <div class="weui-cell weui-cell_select weui-cell_select-after">
          <div class="weui-cell__hd">
              <label for="" class="weui-label">级别</label>
          </div>
          <div class="weui-cell__bd">
              <select class="weui-select" name="rank" id="rank" onchange="showCustomer()">
                <option value="">请选择</option>
                <% @rank.each do |rank|%>
                  <option value="<%= rank.id %>"><%= rank.level %></option>
                <% end %>
              </select>
          </div>
      </div>
      <div class="weui-cell weui-cell_select weui-cell_select-after">
          <div class="weui-cell__hd">
              <label for="" class="weui-label">筑脊师</label>
          </div>
          <div class="weui-cell__bd">
            <!-- 在这里选择脊筑师，然后提交表单到ReservationRecord预约记录表中 绑外键ID -->
            <select class="weui-select" name="spine" id="spine">
            </select>
          </div>
      </div>
  </div>

  <div class="weui-btn-area">
      <%= f.submit "预约" ,class:"weui-btn weui-btn_primary" %>
  </div>
  <% end %>
</body>
